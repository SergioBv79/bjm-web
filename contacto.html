<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Contacto | BJM Mantenimientos</title>
  <link rel="stylesheet" href="./css/estilos.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600&display=swap" />
  <link rel="icon" href="./icons/favicons/favicon.ico" type="image/x-icon" />
</head>
<body>
  <header id="header"></header>

  <main class="contacto-bjm animar-aparicion">
    <h1><i class="fas fa-envelope-open-text"></i> Contacto</h1>

    <!-- üîí Bloqueo si no acepta cookies -->
    <div id="bloqueo-formulario" style="display: none;" class="bloqueo-cookies-form">
      <p>Este formulario solo estar√° disponible cuando aceptes las cookies anal√≠ticas.</p>
      <button id="abrir-config-contacto" class="boton-enviar">Cambiar configuraci√≥n de cookies</button>
    </div>

    <!-- ‚úÖ Formulario real -->
    <div id="formulario-contacto-wrapper">
      <section class="formulario-contacto">
        <form action="https://formsubmit.co/serborve@gmail.com" method="POST">
          <!-- ‚úÖ Cuando publiques en dominio real, cambia por:
               https://formsubmit.co/bjmcontacto@bjm-mantenimientos.com -->

          <input type="hidden" name="_next" value="gracias.html" />
          <!-- ‚úÖ En producci√≥n:
               https://www.bjm-mantenimientos.com/gracias.html -->

          <input type="hidden" name="_captcha" value="false" />
          <input type="hidden" name="consentimiento" value="‚úÖ El usuario acept√≥ el tratamiento de datos personales seg√∫n la cl√°usula del formulario." />

          <label for="nombre">Nombre*</label>
          <input type="text" id="nombre" name="nombre" required />

          <label for="email">Correo electr√≥nico*</label>
          <input type="email" id="email" name="email" required />

          <label for="telefono">Tel√©fono</label>
          <input type="tel" id="telefono" name="telefono" />

          <label for="mensaje">Mensaje*</label>
          <textarea id="mensaje" name="mensaje" rows="5" required></textarea>

          <div class="consentimiento">
            <label for="acepto">
              <input type="checkbox" id="acepto" name="acepto" required />
              Autorizo el tratamiento de mis datos personales con el √∫nico fin de gestionar esta solicitud de contacto, incluyendo la posible respuesta por tel√©fono o correo electr√≥nico. 
              Soy consciente de que puedo revocar este consentimiento en cualquier momento.*
            </label>
          </div>

          <button type="submit" class="boton-enviar">Enviar mensaje</button>
        </form>
      </section>
    </div>

    <section class="datos-contacto">
      <h2><i class="fas fa-map-marker-alt"></i> D√≥nde estamos</h2>
      <p><strong>Direcci√≥n:</strong> Calle Aries (La Florida) 6, El Puerto de Santa Mar√≠a, 11500, C√°diz, Espa√±a</p>
      <p><strong>Tel√©fono:</strong> <a href="tel:+34615975960">615 97 59 60</a></p>
      <p><strong>Email:</strong> <a href="mailto:contacto@bjmantenimientos.es">contacto@bjmantenimientos.es</a></p>

      <div class="mapa">
        <iframe
          src="https://www.google.com/maps/embed?pb=!1m14!1m12!1m3!1d3202.6877006524223!2d-6.224013425465787!3d36.609829922302055!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!5e0!3m2!1ses!2ses!4v1748202942854!5m2!1ses!2ses"
          width="100%" height="300" style="border:0;" allowfullscreen loading="lazy"
          referrerpolicy="no-referrer-when-downgrade">
        </iframe>
      </div>

      <a class="whatsapp-contacto" href="https://wa.me/34615975960" target="_blank" rel="noopener">
        <i class="fab fa-whatsapp"></i> Enviar WhatsApp
      </a>
    </section>
  </main>

  <button id="btn-top" title="Volver arriba">&#8679;</button>
  <footer id="footer"></footer>

  <!-- Scripts JS -->
  <script src="./js/header.js" defer></script>
  <script src="./js/footer.js" defer></script>
  <script src="./js/scripts.js" defer></script>
  <script src="./js/menu.js" defer></script>
  <script src="./js/cookies.js" defer></script>

  <!-- Bloqueo y activaci√≥n del formulario -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const wrapper = document.getElementById('formulario-contacto-wrapper');
      const bloqueo = document.getElementById('bloqueo-formulario');
      const modal = document.getElementById('cookie-config-modal');
      const btnAbrir = document.getElementById("abrir-config-contacto");

      // Abrir modal desde el bot√≥n del mensaje de bloqueo
      if (btnAbrir && modal) {
        btnAbrir.addEventListener("click", () => {
          modal.classList.remove("oculto");
        });
      }

      // Mostrar u ocultar formulario seg√∫n cookies aceptadas
      function cookiesAnaliticasAceptadas() {
        const estado = localStorage.getItem("cookies_accepted");
        if (estado === "all") return true;
        if (estado === "custom") {
          try {
            const prefs = JSON.parse(localStorage.getItem("cookies_custom"));
            return prefs?.analytics === true;
          } catch {
            return false;
          }
        }
        return false;
      }

      if (cookiesAnaliticasAceptadas()) {
        wrapper.style.display = "block";
        bloqueo.style.display = "none";
      } else {
        wrapper.style.display = "none";
        bloqueo.style.display = "block";
      }
    });
  </script>
</body>
</html>
